{
  "statistics": {
    "detectionDate": "2026-01-11T00:01:42.820Z",
    "formats": {
      "python": {
        "sources": {
          "cookie/wsgi.py": {
            "lines": 10,
            "tokens": 40,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "cookie/urls.py": {
            "lines": 35,
            "tokens": 280,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "cookie/settings.py": {
            "lines": 171,
            "tokens": 948,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/recipes/management/commands/cleanup_search_images.py": {
            "lines": 112,
            "tokens": 580,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/recipes/services/search.py": {
            "lines": 525,
            "tokens": 3345,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/recipes/services/scraper.py": {
            "lines": 415,
            "tokens": 3135,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/recipes/services/image_cache.py": {
            "lines": 270,
            "tokens": 1534,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/recipes/services/fingerprint.py": {
            "lines": 78,
            "tokens": 279,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/legacy/templatetags/legacy_tags.py": {
            "lines": 52,
            "tokens": 286,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/ai/services/validator.py": {
            "lines": 263,
            "tokens": 2124,
            "sources": 1,
            "clones": 4,
            "duplicatedLines": 56,
            "duplicatedTokens": 432,
            "percentage": 21.29,
            "percentageTokens": 20.34,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/ai/services/tips.py": {
            "lines": 107,
            "tokens": 532,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/ai/services/timer.py": {
            "lines": 68,
            "tokens": 345,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/ai/services/selector.py": {
            "lines": 178,
            "tokens": 870,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/ai/services/scaling.py": {
            "lines": 240,
            "tokens": 1534,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 15,
            "duplicatedTokens": 99,
            "percentage": 6.25,
            "percentageTokens": 6.45,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/ai/services/remix.py": {
            "lines": 310,
            "tokens": 1836,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 45,
            "duplicatedTokens": 273,
            "percentage": 14.52,
            "percentageTokens": 14.87,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/ai/services/ranking.py": {
            "lines": 161,
            "tokens": 939,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/ai/services/openrouter.py": {
            "lines": 294,
            "tokens": 1795,
            "sources": 1,
            "clones": 4,
            "duplicatedLines": 66,
            "duplicatedTokens": 458,
            "percentage": 22.45,
            "percentageTokens": 25.52,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/ai/services/discover.py": {
            "lines": 277,
            "tokens": 1814,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/recipes/utils.py": {
            "lines": 180,
            "tokens": 1032,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/recipes/sources_api.py": {
            "lines": 298,
            "tokens": 2034,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/recipes/models.py": {
            "lines": 275,
            "tokens": 2135,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/recipes/api_user.py": {
            "lines": 305,
            "tokens": 2050,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/recipes/api.py": {
            "lines": 323,
            "tokens": 2050,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/profiles/utils.py": {
            "lines": 57,
            "tokens": 275,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/profiles/models.py": {
            "lines": 26,
            "tokens": 209,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/profiles/apps.py": {
            "lines": 5,
            "tokens": 32,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/profiles/api.py": {
            "lines": 259,
            "tokens": 1790,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/legacy/views.py": {
            "lines": 365,
            "tokens": 2604,
            "sources": 1,
            "clones": 16,
            "duplicatedLines": 166,
            "duplicatedTokens": 1296,
            "percentage": 45.48,
            "percentageTokens": 49.77,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/legacy/urls.py": {
            "lines": 19,
            "tokens": 206,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/legacy/apps.py": {
            "lines": 9,
            "tokens": 39,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/core/models.py": {
            "lines": 23,
            "tokens": 172,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/core/middleware.py": {
            "lines": 63,
            "tokens": 391,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/core/apps.py": {
            "lines": 5,
            "tokens": 32,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/core/api.py": {
            "lines": 197,
            "tokens": 1259,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/ai/models.py": {
            "lines": 129,
            "tokens": 856,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "apps/ai/api.py": {
            "lines": 734,
            "tokens": 4824,
            "sources": 1,
            "clones": 14,
            "duplicatedLines": 218,
            "duplicatedTokens": 1506,
            "percentage": 29.7,
            "percentageTokens": 31.22,
            "newDuplicatedLines": 0,
            "newClones": 0
          }
        },
        "total": {
          "lines": 6838,
          "tokens": 44206,
          "sources": 36,
          "clones": 21,
          "duplicatedLines": 283,
          "duplicatedTokens": 2032,
          "percentage": 4.14,
          "percentageTokens": 4.6,
          "newDuplicatedLines": 0,
          "newClones": 0
        }
      }
    },
    "total": {
      "lines": 6838,
      "tokens": 44206,
      "sources": 36,
      "clones": 21,
      "duplicatedLines": 283,
      "duplicatedTokens": 2032,
      "percentage": 4.14,
      "percentageTokens": 4.6,
      "newDuplicatedLines": 0,
      "newClones": 0
    }
  },
  "duplicates": [
    {
      "format": "python",
      "lines": 15,
      "fragment": ": {\n        'type': 'array',\n        'items': {\n            'type': 'object',\n            'required': ['search_query', 'title', 'description'],\n            'properties': {\n                'search_query': {'type': 'string'},\n                'title': {'type': 'string'},\n                'description': {'type': 'string'},\n            },\n        },\n        'minItems': 1,\n        'maxItems': 5,\n    },\n    'discover_new'",
      "tokens": 0,
      "firstFile": {
        "name": "apps/ai/services/validator.py",
        "start": 75,
        "end": 89,
        "startLoc": {
          "line": 75,
          "column": 20,
          "position": 663
        },
        "endLoc": {
          "line": 89,
          "column": 15,
          "position": 771
        }
      },
      "secondFile": {
        "name": "apps/ai/services/validator.py",
        "start": 61,
        "end": 75,
        "startLoc": {
          "line": 61,
          "column": 21,
          "position": 554
        },
        "endLoc": {
          "line": 75,
          "column": 20,
          "position": 662
        }
      }
    },
    {
      "format": "python",
      "lines": 15,
      "fragment": ": {\n        'type': 'array',\n        'items': {\n            'type': 'object',\n            'required': ['search_query', 'title', 'description'],\n            'properties': {\n                'search_query': {'type': 'string'},\n                'title': {'type': 'string'},\n                'description': {'type': 'string'},\n            },\n        },\n        'minItems': 1,\n        'maxItems': 5,\n    },\n    'search_ranking'",
      "tokens": 0,
      "firstFile": {
        "name": "apps/ai/services/validator.py",
        "start": 89,
        "end": 103,
        "startLoc": {
          "line": 89,
          "column": 15,
          "position": 772
        },
        "endLoc": {
          "line": 103,
          "column": 17,
          "position": 880
        }
      },
      "secondFile": {
        "name": "apps/ai/services/validator.py",
        "start": 61,
        "end": 75,
        "startLoc": {
          "line": 61,
          "column": 21,
          "position": 554
        },
        "endLoc": {
          "line": 75,
          "column": 20,
          "position": 662
        }
      }
    },
    {
      "format": "python",
      "lines": 16,
      "fragment": ",\n        modification=modification,\n    )\n\n    # Call AI service\n    service = OpenRouterService()\n    response = service.complete(\n        system_prompt=prompt.system_prompt,\n        user_prompt=user_prompt,\n        model=prompt.model,\n        json_response=True,\n    )\n\n    # Validate response\n    validator = AIResponseValidator()\n    validated = validator.validate('nutrition_estimate'",
      "tokens": 0,
      "firstFile": {
        "name": "apps/ai/services/remix.py",
        "start": 233,
        "end": 248,
        "startLoc": {
          "line": 233,
          "column": 13,
          "position": 1351
        },
        "endLoc": {
          "line": 248,
          "column": 21,
          "position": 1438
        }
      },
      "secondFile": {
        "name": "apps/ai/services/remix.py",
        "start": 107,
        "end": 122,
        "startLoc": {
          "line": 107,
          "column": 17,
          "position": 536
        },
        "endLoc": {
          "line": 122,
          "column": 15,
          "position": 623
        }
      }
    },
    {
      "format": "python",
      "lines": 16,
      "fragment": "numbers = re.findall(r'\\d+', time_str)\n    if not numbers:\n        return None\n\n    minutes = int(numbers[0])\n\n    # Convert hours to minutes if needed\n    if 'hour' in time_str:\n        minutes *= 60\n        if len(numbers) > 1:\n            minutes += int(numbers[1])\n\n    return minutes\n\n\ndef _parse_servings",
      "tokens": 0,
      "firstFile": {
        "name": "apps/ai/services/remix.py",
        "start": 262,
        "end": 277,
        "startLoc": {
          "line": 262,
          "column": 5,
          "position": 1518
        },
        "endLoc": {
          "line": 277,
          "column": 16,
          "position": 1617
        }
      },
      "secondFile": {
        "name": "apps/ai/services/scaling.py",
        "start": 28,
        "end": 43,
        "startLoc": {
          "line": 28,
          "column": 5,
          "position": 164
        },
        "endLoc": {
          "line": 43,
          "column": 13,
          "position": 263
        }
      }
    },
    {
      "format": "python",
      "lines": 21,
      "fragment": "(\n                    messages=messages,\n                    model=model,\n                    stream=False,\n                )\n\n            # Extract the response content\n            if not response or not hasattr(response, 'choices'):\n                raise AIResponseError('Invalid response structure from OpenRouter')\n\n            if not response.choices:\n                raise AIResponseError('No choices in OpenRouter response')\n\n            content = response.choices[0].message.content\n\n            if json_response:\n                # Parse JSON from the response\n                try:\n                    # Handle potential markdown code blocks\n                    if content.startswith('```'):\n                        lines",
      "tokens": 0,
      "firstFile": {
        "name": "apps/ai/services/openrouter.py",
        "start": 152,
        "end": 172,
        "startLoc": {
          "line": 152,
          "column": 11,
          "position": 815
        },
        "endLoc": {
          "line": 172,
          "column": 6,
          "position": 935
        }
      },
      "secondFile": {
        "name": "apps/ai/services/openrouter.py",
        "start": 81,
        "end": 101,
        "startLoc": {
          "line": 81,
          "column": 5,
          "position": 372
        },
        "endLoc": {
          "line": 101,
          "column": 31,
          "position": 492
        }
      }
    },
    {
      "format": "python",
      "lines": 14,
      "fragment": "lines = content.split('\\n')\n                        json_lines = []\n                        in_block = False\n                        for line in lines:\n                            if line.startswith('```'):\n                                in_block = not in_block\n                                continue\n                            if in_block:\n                                json_lines.append(line)\n                        content = '\\n'.join(json_lines)\n\n                    return json.loads(content)\n                except json.JSONDecodeError as e:\n                    logger",
      "tokens": 0,
      "firstFile": {
        "name": "apps/ai/services/openrouter.py",
        "start": 172,
        "end": 185,
        "startLoc": {
          "line": 172,
          "column": 25,
          "position": 935
        },
        "endLoc": {
          "line": 185,
          "column": 7,
          "position": 1044
        }
      },
      "secondFile": {
        "name": "apps/ai/services/openrouter.py",
        "start": 102,
        "end": 115,
        "startLoc": {
          "line": 102,
          "column": 25,
          "position": 495
        },
        "endLoc": {
          "line": 115,
          "column": 82,
          "position": 604
        }
      }
    },
    {
      "format": "python",
      "lines": 11,
      "fragment": "profile_id = request.session.get('profile_id')\n    if not profile_id:\n        return redirect('legacy:profile_selector')\n\n    try:\n        profile = Profile.objects.get(id=profile_id)\n    except Profile.DoesNotExist:\n        del request.session['profile_id']\n        return redirect('legacy:profile_selector')\n\n    query",
      "tokens": 0,
      "firstFile": {
        "name": "apps/legacy/views.py",
        "start": 85,
        "end": 95,
        "startLoc": {
          "line": 85,
          "column": 5,
          "position": 592
        },
        "endLoc": {
          "line": 95,
          "column": 6,
          "position": 670
        }
      },
      "secondFile": {
        "name": "apps/legacy/views.py",
        "start": 38,
        "end": 48,
        "startLoc": {
          "line": 38,
          "column": 5,
          "position": 256
        },
        "endLoc": {
          "line": 48,
          "column": 33,
          "position": 334
        }
      }
    },
    {
      "format": "python",
      "lines": 11,
      "fragment": "profile_id = request.session.get('profile_id')\n    if not profile_id:\n        return redirect('legacy:profile_selector')\n\n    try:\n        profile = Profile.objects.get(id=profile_id)\n    except Profile.DoesNotExist:\n        del request.session['profile_id']\n        return redirect('legacy:profile_selector')\n\n    # Get the recipe (must belong to this profile)",
      "tokens": 0,
      "firstFile": {
        "name": "apps/legacy/views.py",
        "start": 112,
        "end": 122,
        "startLoc": {
          "line": 112,
          "column": 5,
          "position": 804
        },
        "endLoc": {
          "line": 122,
          "column": 47,
          "position": 882
        }
      },
      "secondFile": {
        "name": "apps/legacy/views.py",
        "start": 38,
        "end": 48,
        "startLoc": {
          "line": 38,
          "column": 5,
          "position": 256
        },
        "endLoc": {
          "line": 48,
          "column": 33,
          "position": 334
        }
      }
    },
    {
      "format": "python",
      "lines": 14,
      "fragment": "profile_id = request.session.get('profile_id')\n    if not profile_id:\n        return redirect('legacy:profile_selector')\n\n    try:\n        profile = Profile.objects.get(id=profile_id)\n    except Profile.DoesNotExist:\n        del request.session['profile_id']\n        return redirect('legacy:profile_selector')\n\n    # Get the recipe (must belong to this profile)\n    recipe = get_object_or_404(Recipe, id=recipe_id, profile=profile)\n\n    # Check if AI features are available",
      "tokens": 0,
      "firstFile": {
        "name": "apps/legacy/views.py",
        "start": 169,
        "end": 182,
        "startLoc": {
          "line": 169,
          "column": 5,
          "position": 1201
        },
        "endLoc": {
          "line": 182,
          "column": 37,
          "position": 1303
        }
      },
      "secondFile": {
        "name": "apps/legacy/views.py",
        "start": 38,
        "end": 125,
        "startLoc": {
          "line": 38,
          "column": 5,
          "position": 256
        },
        "endLoc": {
          "line": 125,
          "column": 22,
          "position": 906
        }
      }
    },
    {
      "format": "python",
      "lines": 11,
      "fragment": "profile_id = request.session.get('profile_id')\n    if not profile_id:\n        return redirect('legacy:profile_selector')\n\n    try:\n        profile = Profile.objects.get(id=profile_id)\n    except Profile.DoesNotExist:\n        del request.session['profile_id']\n        return redirect('legacy:profile_selector')\n\n    # Get all history for this profile (no limit)",
      "tokens": 0,
      "firstFile": {
        "name": "apps/legacy/views.py",
        "start": 205,
        "end": 215,
        "startLoc": {
          "line": 205,
          "column": 5,
          "position": 1476
        },
        "endLoc": {
          "line": 215,
          "column": 46,
          "position": 1554
        }
      },
      "secondFile": {
        "name": "apps/legacy/views.py",
        "start": 38,
        "end": 48,
        "startLoc": {
          "line": 38,
          "column": 5,
          "position": 256
        },
        "endLoc": {
          "line": 48,
          "column": 33,
          "position": 334
        }
      }
    },
    {
      "format": "python",
      "lines": 11,
      "fragment": "profile_id = request.session.get('profile_id')\n    if not profile_id:\n        return redirect('legacy:profile_selector')\n\n    try:\n        profile = Profile.objects.get(id=profile_id)\n    except Profile.DoesNotExist:\n        del request.session['profile_id']\n        return redirect('legacy:profile_selector')\n\n    # Get all favorites for this profile",
      "tokens": 0,
      "firstFile": {
        "name": "apps/legacy/views.py",
        "start": 238,
        "end": 248,
        "startLoc": {
          "line": 238,
          "column": 5,
          "position": 1706
        },
        "endLoc": {
          "line": 248,
          "column": 37,
          "position": 1784
        }
      },
      "secondFile": {
        "name": "apps/legacy/views.py",
        "start": 38,
        "end": 48,
        "startLoc": {
          "line": 38,
          "column": 5,
          "position": 256
        },
        "endLoc": {
          "line": 48,
          "column": 33,
          "position": 334
        }
      }
    },
    {
      "format": "python",
      "lines": 11,
      "fragment": "profile_id = request.session.get('profile_id')\n    if not profile_id:\n        return redirect('legacy:profile_selector')\n\n    try:\n        profile = Profile.objects.get(id=profile_id)\n    except Profile.DoesNotExist:\n        del request.session['profile_id']\n        return redirect('legacy:profile_selector')\n\n    # Get all collections for this profile",
      "tokens": 0,
      "firstFile": {
        "name": "apps/legacy/views.py",
        "start": 265,
        "end": 275,
        "startLoc": {
          "line": 265,
          "column": 5,
          "position": 1892
        },
        "endLoc": {
          "line": 275,
          "column": 39,
          "position": 1970
        }
      },
      "secondFile": {
        "name": "apps/legacy/views.py",
        "start": 38,
        "end": 48,
        "startLoc": {
          "line": 38,
          "column": 5,
          "position": 256
        },
        "endLoc": {
          "line": 48,
          "column": 33,
          "position": 334
        }
      }
    },
    {
      "format": "python",
      "lines": 11,
      "fragment": "profile_id = request.session.get('profile_id')\n    if not profile_id:\n        return redirect('legacy:profile_selector')\n\n    try:\n        profile = Profile.objects.get(id=profile_id)\n    except Profile.DoesNotExist:\n        del request.session['profile_id']\n        return redirect('legacy:profile_selector')\n\n    # Get the collection (must belong to this profile)",
      "tokens": 0,
      "firstFile": {
        "name": "apps/legacy/views.py",
        "start": 292,
        "end": 302,
        "startLoc": {
          "line": 292,
          "column": 5,
          "position": 2081
        },
        "endLoc": {
          "line": 302,
          "column": 51,
          "position": 2159
        }
      },
      "secondFile": {
        "name": "apps/legacy/views.py",
        "start": 38,
        "end": 48,
        "startLoc": {
          "line": 38,
          "column": 5,
          "position": 256
        },
        "endLoc": {
          "line": 48,
          "column": 33,
          "position": 334
        }
      }
    },
    {
      "format": "python",
      "lines": 11,
      "fragment": "profile_id = request.session.get('profile_id')\n    if not profile_id:\n        return redirect('legacy:profile_selector')\n\n    try:\n        profile = Profile.objects.get(id=profile_id)\n    except Profile.DoesNotExist:\n        del request.session['profile_id']\n        return redirect('legacy:profile_selector')\n\n    # Get app settings",
      "tokens": 0,
      "firstFile": {
        "name": "apps/legacy/views.py",
        "start": 329,
        "end": 339,
        "startLoc": {
          "line": 329,
          "column": 5,
          "position": 2338
        },
        "endLoc": {
          "line": 339,
          "column": 19,
          "position": 2416
        }
      },
      "secondFile": {
        "name": "apps/legacy/views.py",
        "start": 38,
        "end": 48,
        "startLoc": {
          "line": 38,
          "column": 5,
          "position": 256
        },
        "endLoc": {
          "line": 48,
          "column": 33,
          "position": 334
        }
      }
    },
    {
      "format": "python",
      "lines": 20,
      "fragment": "}\n    except Recipe.DoesNotExist:\n        return 404, {\n            'error': 'not_found',\n            'message': f'Recipe {data.recipe_id} not found',\n        }\n    except AIUnavailableError as e:\n        return 503, {\n            'error': 'ai_unavailable',\n            'message': str(e) or 'AI features are not available. Please configure your API key in Settings.',\n            'action': 'configure_key',\n        }\n    except (AIResponseError, ValidationError) as e:\n        return 400, {\n            'error': 'ai_error',\n            'message': str(e),\n        }\n\n\n# Scaling Schemas",
      "tokens": 0,
      "firstFile": {
        "name": "apps/ai/api.py",
        "start": 359,
        "end": 378,
        "startLoc": {
          "line": 359,
          "column": 9,
          "position": 2397
        },
        "endLoc": {
          "line": 378,
          "column": 18,
          "position": 2527
        }
      },
      "secondFile": {
        "name": "apps/ai/api.py",
        "start": 289,
        "end": 308,
        "startLoc": {
          "line": 289,
          "column": 12,
          "position": 1891
        },
        "endLoc": {
          "line": 308,
          "column": 8,
          "position": 2021
        }
      }
    },
    {
      "format": "python",
      "lines": 18,
      "fragment": "from apps.profiles.utils import get_current_profile_or_none\n    profile = get_current_profile_or_none(request)\n\n    if not profile:\n        return 404, {\n            'error': 'not_found',\n            'message': 'Profile not found',\n        }\n\n    # Verify the profile_id in the request matches the session profile\n    if data.profile_id != profile.id:\n        return 404, {\n            'error': 'not_found',\n            'message': f'Profile {data.profile_id} not found',\n        }\n\n    try:\n        recipe",
      "tokens": 0,
      "firstFile": {
        "name": "apps/ai/api.py",
        "start": 413,
        "end": 430,
        "startLoc": {
          "line": 413,
          "column": 5,
          "position": 2766
        },
        "endLoc": {
          "line": 430,
          "column": 7,
          "position": 2872
        }
      },
      "secondFile": {
        "name": "apps/ai/api.py",
        "start": 315,
        "end": 332,
        "startLoc": {
          "line": 315,
          "column": 5,
          "position": 2074
        },
        "endLoc": {
          "line": 332,
          "column": 26,
          "position": 2180
        }
      }
    },
    {
      "format": "python",
      "lines": 16,
      "fragment": ",\n        }\n    except AIUnavailableError as e:\n        return 503, {\n            'error': 'ai_unavailable',\n            'message': str(e) or 'AI features are not available. Please configure your API key in Settings.',\n            'action': 'configure_key',\n        }\n    except (AIResponseError, ValidationError) as e:\n        return 400, {\n            'error': 'ai_error',\n            'message': str(e),\n        }\n\n\n# Tips Schemas",
      "tokens": 0,
      "firstFile": {
        "name": "apps/ai/api.py",
        "start": 475,
        "end": 490,
        "startLoc": {
          "line": 475,
          "column": 2,
          "position": 3223
        },
        "endLoc": {
          "line": 490,
          "column": 15,
          "position": 3322
        }
      },
      "secondFile": {
        "name": "apps/ai/api.py",
        "start": 293,
        "end": 308,
        "startLoc": {
          "line": 293,
          "column": 36,
          "position": 1922
        },
        "endLoc": {
          "line": 308,
          "column": 8,
          "position": 2021
        }
      }
    },
    {
      "format": "python",
      "lines": 13,
      "fragment": "from apps.profiles.utils import get_current_profile_or_none\n    profile = get_current_profile_or_none(request)\n\n    try:\n        # Verify recipe ownership\n        recipe = Recipe.objects.get(id=data.recipe_id)\n        if not profile or recipe.profile_id != profile.id:\n            return 404, {\n                'error': 'not_found',\n                'message': f'Recipe {data.recipe_id} not found',\n            }\n\n        # Clear existing tips if regenerate requested",
      "tokens": 0,
      "firstFile": {
        "name": "apps/ai/api.py",
        "start": 511,
        "end": 523,
        "startLoc": {
          "line": 511,
          "column": 5,
          "position": 3432
        },
        "endLoc": {
          "line": 523,
          "column": 46,
          "position": 3528
        }
      },
      "secondFile": {
        "name": "apps/ai/api.py",
        "start": 276,
        "end": 288,
        "startLoc": {
          "line": 276,
          "column": 5,
          "position": 1776
        },
        "endLoc": {
          "line": 288,
          "column": 12,
          "position": 1872
        }
      }
    },
    {
      "format": "python",
      "lines": 19,
      "fragment": "except Recipe.DoesNotExist:\n        return 404, {\n            'error': 'not_found',\n            'message': f'Recipe {data.recipe_id} not found',\n        }\n    except AIUnavailableError as e:\n        return 503, {\n            'error': 'ai_unavailable',\n            'message': str(e) or 'AI features are not available. Please configure your API key in Settings.',\n            'action': 'configure_key',\n        }\n    except (AIResponseError, ValidationError) as e:\n        return 400, {\n            'error': 'ai_error',\n            'message': str(e),\n        }\n\n\n# Timer Naming Schemas",
      "tokens": 0,
      "firstFile": {
        "name": "apps/ai/api.py",
        "start": 529,
        "end": 547,
        "startLoc": {
          "line": 529,
          "column": 5,
          "position": 3565
        },
        "endLoc": {
          "line": 547,
          "column": 23,
          "position": 3692
        }
      },
      "secondFile": {
        "name": "apps/ai/api.py",
        "start": 290,
        "end": 308,
        "startLoc": {
          "line": 290,
          "column": 5,
          "position": 1894
        },
        "endLoc": {
          "line": 308,
          "column": 8,
          "position": 2021
        }
      }
    },
    {
      "format": "python",
      "lines": 14,
      "fragment": "except AIUnavailableError as e:\n        return 503, {\n            'error': 'ai_unavailable',\n            'message': str(e) or 'AI features are not available. Please configure your API key in Settings.',\n            'action': 'configure_key',\n        }\n    except (AIResponseError, ValidationError) as e:\n        return 400, {\n            'error': 'ai_error',\n            'message': str(e),\n        }\n\n\n# Discover Schemas",
      "tokens": 0,
      "firstFile": {
        "name": "apps/ai/api.py",
        "start": 584,
        "end": 597,
        "startLoc": {
          "line": 584,
          "column": 5,
          "position": 3893
        },
        "endLoc": {
          "line": 597,
          "column": 19,
          "position": 3986
        }
      },
      "secondFile": {
        "name": "apps/ai/api.py",
        "start": 295,
        "end": 308,
        "startLoc": {
          "line": 295,
          "column": 5,
          "position": 1928
        },
        "endLoc": {
          "line": 308,
          "column": 8,
          "position": 2021
        }
      }
    },
    {
      "format": "python",
      "lines": 16,
      "fragment": "),\n        }\n    except AIUnavailableError as e:\n        return 503, {\n            'error': 'ai_unavailable',\n            'message': str(e) or 'AI features are not available. Please configure your API key in Settings.',\n            'action': 'configure_key',\n        }\n    except (AIResponseError, ValidationError) as e:\n        return 400, {\n            'error': 'ai_error',\n            'message': str(e),\n        }\n\n\n@router.get",
      "tokens": 0,
      "firstFile": {
        "name": "apps/ai/api.py",
        "start": 704,
        "end": 719,
        "startLoc": {
          "line": 704,
          "column": 15,
          "position": 4619
        },
        "endLoc": {
          "line": 719,
          "column": 4,
          "position": 4721
        }
      },
      "secondFile": {
        "name": "apps/ai/api.py",
        "start": 475,
        "end": 308,
        "startLoc": {
          "line": 475,
          "column": 2,
          "position": 3222
        },
        "endLoc": {
          "line": 308,
          "column": 5,
          "position": 2023
        }
      }
    }
  ],
  "filename": "/home/runner/.npm/_npx/652ead47bf63fe99/node_modules/@jscpd/html-reporter/dist/templates/main.pug"
}